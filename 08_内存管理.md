---
title: 内存管理
author: Allwayso
update: 2025-12-23
status: Updating
---

---

## 为什么要做内存管理

内存空间有限，并发程序需要同时、互相隔离、高效地使用大量内存

---

## 派生问题

1. 分配：空间管理，让多个程序能高效共存 
2. 隔离：安全保护，防止程序互相干扰或修改操作系统 
3. 共享：提高利用率，让不同进程使用相同的代码段 
4. 扩展：突破物理限制，让大程序能在小内存上运行 

---

## 基础概念

### 虚拟地址空间

为进程创建一片从0开始的、连续的虚拟地址

目的：

1. 代码与位置解耦：程序在哪都能运行，不依赖于硬编码的物理地址
2. 程序员与硬件细节解耦：不需要硬编码程序物理地址
3. 进程与进程解耦：代码之间互相不知道物理地址，实现隔离

### 地址重定位

将虚拟地址映射到物理地址上

静态重定位：进程在创建时确定了一个固定的偏移量，此后不再改变，物理地址相应不变
动态重定位：用基址寄存器存储偏移量，可以改变，物理地址相应改变

### 内存保护

检查逻辑地址是否超过界限寄存器中存储的最大长度，实现进程间物理地址的硬隔离

> 硬隔离：界限寄存器的权限为内核级，程序无法改变

重定位步骤：

1. 安检：检查是否越界，如果越界就抛出段错误，中断进程
2. 翻译：计算实际物理地址
